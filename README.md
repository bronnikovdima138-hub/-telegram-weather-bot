# Telegram Weather Bot

Бот принимает координаты в формате, похожем на:

```
Широта: 47°41'с. ш. / Долгота: 36°49'в. д. / Высота: 119 m
Часовой пояс: Europe/Kyiv (UTC+3)
```

и присылает сводку погоды по фиксированным интервалам, оформленную «столбиком».

## Возможности
- Парсинг координат в DMS (градусы/минуты, кириллица «с. ш.»/«в. д.» поддерживается).
- Reverse geocoding через Nominatim (OSM) для названия населённого пункта.
- Погода из Open‑Meteo: осадки, облачность, T/Td, ветер на 10 м, CAPE.
- Ветра на эшелонах 850/700/600 гПа (GFS/ICON) с интерполяцией на 1500/2500/3500 м.
- Оценка нижней границы облаков (LCL) по T/Td с усреднением по интервалу.

## Структура
- `main.py` — вход, Telegram‑handlers, сбор данных и отправка отчёта.
- `parser.py` — разбор координатной строки.
- `geocode.py` — Nominatim reverse geocoding.
- `weather.py` — запросы Open‑Meteo, агрегация интервалов и формат отчёта.
- `config.py` — загрузка переменных окружения из `.env`.
- `.env.example` — пример файла с переменными.
- `requirements.txt` — зависимости.

## Безопасность токена
Никогда не коммитьте реальный токен. Скопируйте `.env.example` в `.env` и вставьте свой токен локально:

```
TELEGRAM_BOT_TOKEN=1234567890:AA...your_token...
```

Если токен где‑то засветился — в @BotFather выполните `/revoke` и получите новый.

## Установка и запуск (Windows, PowerShell)
1. Создайте и активируйте виртуальное окружение (по желанию):
   ```powershell
   py -3 -m venv .venv
   .\.venv\Scripts\Activate.ps1
   ```
2. Установите зависимости:
   ```powershell
   pip install -r requirements.txt
   ```
3. Создайте `.env` и вставьте токен:
   ```env
   TELEGRAM_BOT_TOKEN=ВАШ_ТОКЕН_ОТ_BOTFATHER
   ```
4. Запуск бота (polling):
   ```powershell
   python .\main.py
   ```

После запуска отправьте боту сообщение с координатами. Бот ответит сводкой.

## Замечания
- Таймзона: если в тексте есть строка `Часовой пояс: ...`, бот постарается её использовать; иначе — автоматическая зона Open‑Meteo.
- Интервальные блоки: 00–03, 03–06, 06–12, 12–15, 15–18, 18–20, 20–23.
- Для продакшена можно перевести на webhook и хостинг (Render/Fly.io/VPS).
